# ExcelLoaderIn1C
Загрузка данных в 1С из файла excel (универсальная)

С минимальнами настройками обработка позволит загрузить данные из excel в ЛОБОЙ объект 1С

# Как настроить на загрузку "своего" объекта

1.1 Откроем модуль основной формы (у обработки одна основная форма)
1.2 Находим Область ИнициализацияДоступныхКСозданиюТипов
1.3 Добавляем в список выбора: тип, наименование, синоним объекта который надо СОЗДАТЬ и заполнить
Элементы.ИмяСоздаваемогоОбъекта.СписокВыбора.Добавить(
	"Документ.ИмяОбъектаКонфигурации",
  "Синоним объекта для представления пользователю"
	);
![image](https://user-images.githubusercontent.com/28355711/209112897-64d5e6b8-f000-4d35-a02b-015aa5368afc.png)
 
 2.1 Добавляем данной обработке макет точно с таким наименованием как "ИмяОбъектаКонфигурации" (см. пункт 1.3)
![image](https://user-images.githubusercontent.com/28355711/209112595-56125754-3651-4ed6-b9c8-e93f1ad959a8.png)

 2.2 Необходимо описать значения по умолчанию для шапки обработки в области "ШапкаОбработки"
 2.3 Необходимо описать типы загружаемых значений, а также привязать их к конкретным колонкам (в какие колонки заносить данные excel) в области "СопоставлениеКолонок"
 
  // ВСЕГДА в макете должно быть две области "ШапкаОбработки" и "СопоставлениеКолонок" (см. созданные как пример)
![image](https://user-images.githubusercontent.com/28355711/209112474-0acefb14-ef10-4a35-8009-c45ff95ab104.png)

Интерфейс обработки в режиме предприятия
![image](https://user-images.githubusercontent.com/28355711/209115521-66b0a3f0-a65b-48e5-bc10-0cb403ec5601.png)

// ВСЕГДА должен быть хотя бы один ключ!

# Как описывать данные в макете

Далее буду писать документ конфигурации имея ввиду документ добавленный в разделе 1.3 (но это может быть как документ так и справочник)

Область "СопоставлениеКолонок":

"ПутьКДанным" - Имя реквизита документа конфигурации, если реквизит находится в табличной части документа конфигурации тогд укажите его так
ИмяТаблицы.ИмяРеквизита (через точку имя таблицы и имя реквизита)

"Тип" - аналогичным образом (Типа точка ИмяОбъекта) указываем какого типа должен быть реквизит (указанный в "ПутьКДанным")

"Синоним" - Это для представления пользователю в интерфейсе обработки

"ИскатьПо" - доступные значения: "Код", "Наименование", "Реквизти", "Ложь" (это по какому реквизиту искать ссылочные типы)
ВСЕГДА должно быть заполнено (для примитивных типов заполняем как "Ложь"), если указали "Реквизит" тогда через точку наименование реквизита

"СоздатьЕслиОтсутствует" - КРАЙНЕ НЕ РЕКОМЕНДУЕТСЯ заполнять как "Истина" лучше всегда оставить "Ложь" (доступные знч "Истина", "Ложь")
на форме обработки можно перед выполнением изменить, то что указано в макете подтягивает как знч по умолчанию, но на форме видимость реквизиту "СоздатьЕслиОтсутствует"
установлена в ЛОЖЬ (стремно давать пользователю возможность управлять данной галочкой, но если хочется то можете установить видимость как ИСТИНА)

"НомерКолонки" - Какой номер колонки в файле excel содержит значение для данного реквизита (нумерация от единицы)

"Ключ" - Это значение отвечает за переход к созданию нового документа конфигурации, новый документ будет создан по началу и далее когда значение ключевых колонок
изменятся. (Пока в колонке ключ значение повторяется мы считаем что это один документ, а изменившись мы создаем новый документ конфигурации и наполняем уже его)
ВСЕГДА ДОЛЖЕН БЫТЬ ВЫБРАН ХОТЯ БЫ ОДИН КЛЮЧ!!!
